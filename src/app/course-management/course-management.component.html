<app-admin-nav />

    <main class="md:ml-64 pt-20">
        <div class="p-1">
  <!-- Header -->
  <div class="flex justify-between items-center mb-8 p-1 ">
    <h1 class="text-2xl font-bold text-gray-900">Course Management</h1>
    <button 
      (click)="openCourseModal()" 
      class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
    >
      <i class="fas fa-plus mr-2"></i> Create New Course
    </button>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="flex justify-center items-center p-12">
    <div class="animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="mb-6 p-4 bg-red-100 border border-red-400 text-red-700 rounded-lg">
    <div class="flex justify-between items-center">
      <span>{{ errorMessage }}</span>
      <button (click)="errorMessage = ''" class="text-red-700 hover:text-red-900">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>

  <!-- Success Message -->
  <div *ngIf="successMessage" class="mb-6 p-4 bg-green-100 border border-green-400 text-green-700 rounded-lg">
    <div class="flex justify-between items-center">
      <span>{{ successMessage }}</span>
      <button (click)="successMessage = ''" class="text-green-700 hover:text-green-900">
        <i class="fas fa-times"></i>
      </button>
    </div>
  </div>

  <!-- Courses List -->
  <div *ngIf="!isLoading" class="bg-white shadow rounded-lg overflow-hidden mb-8">
    <div class="px-6 py-4 border-b border-gray-200 flex items-center justify-between">
      <h2 class="text-lg font-medium text-gray-900">All Courses ({{ filteredCourses.length }})</h2>
      <div class="relative w-64">
        <input 
          type="text" 
          [(ngModel)]="searchTerm" 
          (input)="filterCourses()"
          placeholder="Search courses..." 
          class="pl-10 pr-4 py-2 border border-gray-300 rounded-lg w-full focus:ring-green-500 focus:border-green-500"
        >
        <i class="fas fa-search absolute left-3 top-3 text-gray-400"></i>
      </div>
    </div>
    
    <div class="divide-y divide-gray-200">
      <!-- Course Item -->
      <div *ngFor="let course of filteredCourses" class="p-6 hover:bg-gray-50 transition-colors">
        <div class="flex items-start justify-between">
          <div class="flex items-start">
            <div [class]="'flex-shrink-0 p-3 rounded-lg mr-4 ' + getCategoryColor(course.category)">
              <i [class]="'fas ' + getCategoryIcon(course.category) + ' text-xl'"></i>
            </div>
            <div>
              <h3 class="text-lg font-bold text-gray-900 mb-1">{{ course.title }}</h3>
              <p class="text-sm text-gray-500 mb-2">{{ course.description }}</p>
              <p class="text-sm text-gray-500 mb-2">
                {{ course.chapterCount }} chapters • {{ course.estimatedDuration }} hours • {{ course.enrollmentCount }} enrollments
              </p>
              <div class="flex items-center text-sm">
                <span [class]="'px-2 py-1 rounded-full mr-2 ' + getStatusClass(getCourseStatus(course))">
                  {{ getCourseStatus(course) }}
                </span>
                <span class="text-gray-500">Instructor: {{ course.instructorName }}</span>
                <span class="text-gray-500 mx-2">•</span>
                <span class="text-gray-500">Last updated: {{ course.updatedDate | date:'mediumDate' }}</span>
              </div>
            </div>
          </div>
        <div class="flex space-x-2">
  <button 
    (click)="openCourseModal(course)" 
    class="p-2 text-gray-500 hover:text-green-600 hover:bg-green-50 rounded-lg transition-colors"
  >
    <i class="fas fa-edit"></i>
  </button>
  <button 
    (click)="openChaptersModal(course)" 
    class="p-2 text-gray-500 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors"
  >
    <i class="fas fa-list"></i>
  </button>
  <button 
    (click)="viewQuestions(course)" 
    class="p-2 text-gray-500 hover:text-purple-600 hover:bg-purple-50 rounded-lg transition-colors"
    [class.text-purple-600]="course.chapterCount > 0" 
    [class.bg-purple-50]="course.chapterCount > 0"
  >
    <i class="fas fa-question-circle"></i>
    <span *ngIf="course.chapterCount > 0" class="ml-1 text-xs">({{ course.chapterCount }})</span>
  </button>
  <button 
    (click)="deleteCourse(course.id)" 
    class="p-2 text-gray-500 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors"
  >
    <i class="fas fa-trash"></i>
  </button>
</div>
    </div>
  </div>
</div>

<!-- Course Modal -->
<div 
  *ngIf="showCourseModal" 
  class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4"
  (click)="showCourseModal = false"
>
  <div 
    class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto"
    (click)="$event.stopPropagation()"
  >
    <div class="p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">
          {{ selectedCourse ? 'Edit Course' : 'Create New Course' }}
        </h3>
        <button 
          (click)="showCourseModal = false" 
          class="text-gray-400 hover:text-gray-500 transition-colors"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <!-- Course Info Tabs -->
      <div class="border-b border-gray-200 mb-6">
        <div class="flex space-x-8">
          <button 
            [class]="'py-4 px-1 font-medium text-sm border-b-2 ' + (activeTab === 'basic' ? 'border-green-500 text-green-600' : 'border-transparent text-gray-500 hover:text-gray-700')"
            (click)="activeTab = 'basic'"
          >
            Basic Info
          </button>
        </div>
      </div>
      
      <!-- Basic Info Tab Content -->
      <div *ngIf="activeTab === 'basic'">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Course Title *</label>
            <input 
              type="text" 
              [(ngModel)]="courseForm.title"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
              placeholder="Enter course title"
            >
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Category</label>
            <select 
              [(ngModel)]="courseForm.category"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
            >
              <option value="Health">Health</option>
              <option value="Safety">Safety</option>
              <option value="Mental Health">Mental Health</option>
              <option value="Education">Education</option>
            </select>
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Estimated Duration (hours) *</label>
            <input 
              type="number" 
              [(ngModel)]="courseForm.estimatedDuration"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
              placeholder="Enter duration"
              min="1"
            >
          </div>
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Thumbnail URL</label>
            <input 
              type="url" 
              [(ngModel)]="courseForm.thumbnailUrl"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
              placeholder="https://example.com/thumbnail.jpg"
            >
          </div>
        </div>
        
        <div class="mb-6">
          <label class="block text-sm font-medium text-gray-700 mb-1">Description *</label>
          <textarea 
            rows="4" 
            [(ngModel)]="courseForm.description"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
            placeholder="Describe what students will learn in this course..."
          ></textarea>
        </div>
        
        <div class="flex justify-end space-x-3">
          <button 
            (click)="showCourseModal = false" 
            class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
          >
            Cancel
          </button>
          <button 
            (click)="selectedCourse ? updateCourse(selectedCourse.id) : createCourse()" 
            [disabled]="!courseForm.title || !courseForm.description || !courseForm.estimatedDuration"
            [class]="'px-4 py-2 rounded-lg transition-colors ' + 
              (!courseForm.title || !courseForm.description || !courseForm.estimatedDuration ? 
               'bg-gray-400 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700 text-white')"
          >
            {{ selectedCourse ? 'Update Course' : 'Create Course' }}
          </button>
        </div>
      </div>
    </div>
  </div>
</div>
<div 
  *ngIf="showChaptersModal && selectedCourse" 
  class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4"
  (click)="showChaptersModal = false"
>
  <div 
    class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto"
    (click)="$event.stopPropagation()"
  >
    <div class="p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">
          {{ selectedChapterForEdit ? 'Edit Chapter' : 'Manage Chapters' }}: {{ selectedCourse.title }}
        </h3>
        <button 
          (click)="selectedChapterForEdit ? cancelEditChapter() : showChaptersModal = false" 
          class="text-gray-400 hover:text-gray-500 transition-colors"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <!-- Add/Edit Chapter Form -->
      <div class="bg-gray-50 p-4 rounded-lg mb-6">
        <h4 class="font-medium text-gray-900 mb-3">
          {{ selectedChapterForEdit ? 'Edit Chapter' : 'Add New Chapter' }}
        </h4>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-4">
          <div>
            <label class="block text-sm font-medium text-gray-700 mb-1">Chapter Title *</label>
            <input 
              type="text" 
              [(ngModel)]="chapterForm.title"
              class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
              placeholder="Enter chapter title"
            >
          </div>
       
        </div>
        <div class="mb-4">
          <label class="block text-sm font-medium text-gray-700 mb-1">Content</label>
          <textarea 
            rows="3" 
            [(ngModel)]="chapterForm.content"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
            placeholder="Enter chapter content..."
          ></textarea>
        </div>
        
        <!<div class="mb-4">
  <label class="block text-sm font-medium text-gray-700 mb-2">Media</label>
  
  <!-- File Upload with Preview -->
  <div class="mb-3">
    <label class="block text-sm font-medium text-gray-700 mb-1">Upload Media File *</label>
    
    <!-- File Preview -->
    <div *ngIf="selectedFile" class="mb-3 p-3 border border-gray-200 rounded-lg">
      <div class="flex items-center">
        <!-- Image Preview -->
        <div *ngIf="chapterForm.mediaType === 'image'" class="mr-3">
          <img [src]="getFilePreviewUrl()" class="w-16 h-16 object-cover rounded" alt="Preview">
        </div>
        
        <!-- Video Preview -->
        <div *ngIf="chapterForm.mediaType === 'video'" class="mr-3">
          <video class="w-16 h-16 rounded" controls>
            <source [src]="getFilePreviewUrl()" [type]="selectedFile.type">
          </video>
        </div>
        
        <!-- Document/File Icon -->
        <div *ngIf="chapterForm.mediaType !== 'image' && chapterForm.mediaType !== 'video'" class="mr-3">
          <i class="fas fa-file text-3xl text-blue-500"></i>
        </div>
        
        <div class="flex-1">
          <p class="text-sm font-medium">{{ selectedFile.name }}</p>
          <p class="text-xs text-gray-500">
            Type: {{ chapterForm.mediaType }} • 
            Size: {{ (selectedFile.size / 1024 / 1024).toFixed(2) }} MB
          </p>
        </div>
        
        <button (click)="selectedFile = null" class="text-red-500 hover:text-red-700">
          <i class="fas fa-times"></i>
        </button>
      </div>
    </div>
    
    <!-- File Input -->
    <div class="flex items-center">
      <input 
        type="file" 
        (change)="onFileSelected($event)"
        class="hidden" 
        id="mediaFile"
        accept="video/*,audio/*,image/*,.pdf,.doc,.docx,.txt"
      >
      <label for="mediaFile" class="cursor-pointer mr-3 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
        <i class="fas fa-upload mr-2"></i> Choose File
      </label>
      <span class="text-sm text-gray-500">Supported: Videos, Audio, Images, PDFs</span>
    </div>
    
    <!-- Auto-detected Media Type -->
    <div *ngIf="selectedFile" class="mt-2 text-sm text-gray-600">
      <i class="fas fa-info-circle mr-1"></i>
      Detected as: <span class="font-medium capitalize">{{ chapterForm.mediaType }}</span>
    </div>
  </div>
  
</div>
        
        <div class="flex space-x-3">
          <button 
            (click)="selectedChapterForEdit ? updateChapter() : addChapter(selectedCourse.id)" 
            [disabled]="!chapterForm.title"
            [class]="'px-4 py-2 rounded-lg transition-colors ' + 
              (!chapterForm.title ? 'bg-gray-400 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700 text-white')"
          >
            {{ selectedChapterForEdit ? 'Update Chapter' : 'Add Chapter' }}
          </button>
          
          <button 
            *ngIf="selectedChapterForEdit"
            (click)="cancelEditChapter()"
            class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
          >
            Cancel
          </button>
        </div>
      </div>
      
      <!-- Chapters List -->
      <div class="space-y-4">
        <h4 class="font-medium text-gray-900">Chapters ({{ selectedCourseChapters.length }})</h4>
        
   <!-- In your chapters list, add media previews -->
<div *ngFor="let chapter of selectedCourseChapters" class="border border-gray-200 rounded-lg overflow-hidden mb-4">
  <div class="bg-gray-50 px-4 py-3 flex items-center justify-between">
    <div class="flex items-center">
      <i class="fas fa-grip-vertical text-gray-400 mr-3"></i>
      <h4 class="font-medium text-gray-900">Chapter {{ chapter.order }}: {{ chapter.title }}</h4>
    </div>
    <div class="flex space-x-2">
      <button (click)="editChapter(chapter)" class="text-gray-500 hover:text-green-600">
        <i class="fas fa-edit"></i>
      </button>
      <button (click)="deleteChapter(chapter.id)" class="text-gray-500 hover:text-red-600">
        <i class="fas fa-trash"></i>
      </button>
    </div>
  </div>
  
  <div class="px-4 py-3">
    <p class="text-sm text-gray-600 mb-3">{{ chapter.content }}</p>
    
    <!-- Media Preview -->
    <div *ngIf="chapter.mediaUrl" class="mt-3 p-3 bg-gray-50 rounded-lg">
      <h5 class="text-sm font-medium text-gray-700 mb-2">Attached Media:</h5>
      
      <!-- Video Preview -->
      <div *ngIf="chapter.mediaType === 'video'" class="mt-2">
        <video class="w-full max-w-md rounded-lg" controls>
          <source [src]="chapter.mediaUrl" type="video/mp4">
          Your browser does not support the video tag.
        </video>
      </div>
      
      <!-- Image Preview -->
      <div *ngIf="chapter.mediaType === 'image'" class="mt-2">
        <img [src]="chapter.mediaUrl" class="w-full max-w-md rounded-lg" alt="Chapter media">
      </div>
      
      <!-- Audio Preview -->
      <div *ngIf="chapter.mediaType === 'audio'" class="mt-2">
        <audio controls class="w-full">
          <source [src]="chapter.mediaUrl" type="audio/mpeg">
          Your browser does not support the audio element.
        </audio>
      </div>
      
      <!-- Document/File Link -->
      <div *ngIf="chapter.mediaType === 'document' || chapter.mediaType === 'file'" class="mt-2">
        <a [href]="chapter.mediaUrl" target="_blank" class="inline-flex items-center text-blue-600 hover:text-blue-800">
          <i class="fas fa-file-download mr-2"></i>
          Download {{ chapter.mediaType | titlecase }} File
        </a>
      </div>
      
      <p class="text-xs text-gray-500 mt-2">
        Type: {{ chapter.mediaType }} • 
        <a [href]="chapter.mediaUrl" target="_blank" class="text-blue-500 hover:text-blue-700">View Original</a>
      </p>
    </div>
  </div>
</div>
   
        <!-- Empty Chapters State -->
        <div *ngIf="selectedCourseChapters.length === 0" class="text-center py-8 text-gray-500">
          <i class="fas fa-list-alt text-3xl mb-3"></i>
          <p>No chapters added yet. Start by adding your first chapter.</p>
        </div>
      </div>
      
      <div class="flex justify-end mt-6">
        <button 
          (click)="showChaptersModal = false" 
          class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
        >
          Close
        </button>
      </div>
    </div>
  </div>
</div>


<!-- Add Questions Modal -->
<div 
  *ngIf="showAddQuestionsModal && selectedCourse && selectedCourseTest" 
  class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4"
  (click)="showAddQuestionsModal = false"
>
  <div 
    class="bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-y-auto"
    (click)="$event.stopPropagation()"
  >
    <div class="p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">
          Add Questions to: {{ selectedCourseTest.title }}
        </h3>
        <button 
          (click)="showAddQuestionsModal = false" 
          class="text-gray-400 hover:text-gray-500 transition-colors"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>

<!-- Enhanced quiz modal section -->
<div class="bg-gray-50 p-4 rounded-lg mb-4">
  <h5 class="font-medium text-gray-900 mb-3">Add New Question</h5>
  
  <div class="mb-4">
    <label class="block text-sm font-medium text-gray-700 mb-1">Question Text *</label>
    <input 
      type="text" 
      [(ngModel)]="newQuestion.questionText"
      class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
      placeholder="Enter your question..."
    >
  </div>
  
  <!-- Options for the new question -->
  <div class="mb-4" *ngIf="newQuestion.questionText">
    <label class="block text-sm font-medium text-gray-700 mb-2">Options *</label>
    
    <div class="grid grid-cols-1 md:grid-cols-2 gap-2 mb-3">
      <input 
        type="text" 
        [(ngModel)]="newOption.optionText"
        class="border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
        placeholder="Option text..."
        (keyup.enter)="addOptionToNewQuestion()"
      >
      <div class="flex items-center">
        <input 
          type="checkbox" 
          [(ngModel)]="newOption.isCorrect"
          class="h-4 w-4 text-green-600 focus:ring-green-500 border-gray-300 rounded mr-2"
        >
        <label class="text-sm text-gray-700">Correct answer</label>
      </div>
    </div>
    
    <button 
      (click)="addOptionToNewQuestion()" 
      [disabled]="!newOption.optionText"
      class="px-3 py-1 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm mr-2"
    >
      Add Option
    </button>
    
    <!-- Show added options preview -->
    <div *ngIf="newQuestion.options && newQuestion.options.length > 0" class="mt-3">
      <p class="text-sm font-medium text-gray-700 mb-1">Options added:</p>
      <ul class="text-sm text-gray-600">
        <li *ngFor="let option of newQuestion.options; let i = index" class="flex items-center mb-1">
          <span class="mr-2">{{ i+1 }}.</span>
          <span class="flex-1">{{ option.optionText }}</span>
          <span *ngIf="option.isCorrect" class="ml-2 px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">
            Correct
          </span>
          <button 
            (click)="removeNewOption(i)" 
            class="ml-2 text-red-600 hover:text-red-800"
          >
            <i class="fas fa-times"></i>
          </button>
        </li>
      </ul>
    </div>
  </div>
  
  <button 
    (click)="addQuestion()" 
    [disabled]="!newQuestion.questionText || !newQuestion.options || newQuestion.options.length < 2"
    class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors"
  >
    Add Question to Quiz
  </button>
</div>


<!-- Test status indicator -->
<!-- Test status indicator -->
<div *ngIf="selectedCourseTest" class="mb-4 p-3 bg-blue-50 border border-blue-200 rounded-lg">
  <div class="flex items-center">
    <i class="fas fa-info-circle text-blue-600 mr-2"></i>
    <span class="text-sm text-blue-800">
      Editing existing test with {{ testForm.questions.length || 0 }} questions
    </span>
  </div>
</div>

<div *ngIf="!selectedCourseTest" class="mb-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg">
  <div class="flex items-center">
    <i class="fas fa-exclamation-triangle text-yellow-600 mr-2"></i>
    <span class="text-sm text-yellow-800">No test exists yet for this course. Create a new one.</span>
  </div>
</div>
      <!-- Add this section right after the test status indicator -->
<div class="mb-6" *ngIf="testForm.questions && testForm.questions.length > 0">
  <h4 class="text-lg font-medium text-gray-900 mb-4">Existing Questions ({{ testForm.questions.length }})</h4>
  
  <div class="space-y-4">
    <!-- Question Item -->
    <div *ngFor="let question of testForm.questions; let qIndex = index" 
         class="border border-gray-200 rounded-lg p-4 bg-white">
      <div class="flex justify-between items-start mb-3">
        <h5 class="font-medium text-gray-900">
          Q{{ qIndex + 1 }}: {{ question.questionText }}
        </h5>
        <button 
          (click)="removeQuestion(qIndex)" 
          class="text-red-600 hover:text-red-800"
        >
          <i class="fas fa-trash"></i>
        </button>
      </div>
      
      <!-- Options List -->
      <div class="space-y-2 ml-4">
        <div *ngFor="let option of question.options; let oIndex = index" 
             class="flex items-center">
          <span class="w-6 h-6 flex items-center justify-center rounded-full border border-gray-300 mr-2"
                [class.bg-green-100]="option.isCorrect"
                [class.border-green-500]="option.isCorrect">
            {{ oIndex + 1 }}
          </span>
          <span class="flex-1" [class.font-medium]="option.isCorrect"
                [class.text-green-700]="option.isCorrect">
            {{ option.optionText }}
          </span>
          <span *ngIf="option.isCorrect" class="ml-2 px-2 py-1 bg-green-100 text-green-800 text-xs rounded-full">
            Correct
          </span>
          <button 
            (click)="removeOption(qIndex, oIndex)" 
            class="ml-2 text-red-600 hover:text-red-800"
          >
            <i class="fas fa-times"></i>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Empty state for questions -->
<div *ngIf="testForm.questions && testForm.questions.length === 0" class="text-center py-8 text-gray-500">
  <i class="fas fa-question-circle text-3xl mb-3"></i>
  <p>No questions added yet. Start by adding your first question above.</p>
</div>
          <div class="flex justify-end space-x-3 mt-6">
        <button 
          (click)="showAddQuestionsModal = false" 
          class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
        >
          Cancel
        </button>
        <button 
          (click)="addQuestionsToTest(selectedCourse.id)" 
          [disabled]="testForm.questions.length === 0"
          [class]="'px-4 py-2 rounded-lg transition-colors ' + 
            (testForm.questions.length === 0 ? 'bg-gray-400 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700 text-white')"
        >
          Save Questions
        </button>
      </div>
    </div>
  </div>
</div>


<!-- Create Test Basic Modal -->
<div 
  *ngIf="showCreateTestModal && selectedCourse" 
  class="fixed inset-0 bg-gray-500 bg-opacity-75 flex items-center justify-center z-50 p-4"
  (click)="showCreateTestModal = false"
>
  <div 
    class="bg-white rounded-lg shadow-xl w-full max-w-2xl"
    (click)="$event.stopPropagation()"
  >
    <div class="p-6">
      <div class="flex justify-between items-center mb-6">
        <h3 class="text-2xl font-bold text-gray-900">
          Create Test for {{ selectedCourse.title }}
        </h3>
        <button 
          (click)="showCreateTestModal = false" 
          class="text-gray-400 hover:text-gray-500 transition-colors"
        >
          <i class="fas fa-times"></i>
        </button>
      </div>
      
      <div class="space-y-4">
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Test Title *</label>
          <input 
            type="text" 
            [(ngModel)]="testBasicForm.title"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
            placeholder="Enter test title"
          >
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Description</label>
          <textarea 
            rows="3" 
            [(ngModel)]="testBasicForm.description"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
            placeholder="Describe the test..."
          ></textarea>
        </div>
        
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-1">Passing Score (%)</label>
          <input 
            type="number" 
            [(ngModel)]="testBasicForm.passingScore"
            class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-green-500 focus:border-green-500"
            min="0"
            max="100"
          >
        </div>
      </div>
      
      <div class="flex justify-end space-x-3 mt-6">
        <button 
          (click)="showCreateTestModal = false" 
          class="px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors"
        >
          Cancel
        </button>
        <button 
          (click)="createTestBasic(selectedCourse.id)" 
          [disabled]="!testBasicForm.title"
          [class]="'px-4 py-2 rounded-lg transition-colors ' + 
            (!testBasicForm.title ? 'bg-gray-400 cursor-not-allowed' : 'bg-green-600 hover:bg-green-700 text-white')"
        >
          Create Test
        </button>
      </div>
    </div>
  </div>
</div>
